Unsorted code. Will be moved to a new branch later.